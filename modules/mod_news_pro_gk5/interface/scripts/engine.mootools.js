var NSP5=new Class({animation:!0,anim_arts:!1,anim_lists:!1,arts:null,arts_block_width:0,arts_current:0,arts_pages:null,arts_per_page:null,arts_scroller:null,config:null,hover_anim:null,links:null,links_block_width:0,links_pages:null,links_pages_amount:null,links_scroller:null,links_current:0,modInterface:null,module:null,swipe_max_time:500,swipe_min_move:30,initialize:function(a){this.init_fields(a),this.init_interface()},init_fields:function(module){this.module=module,this.module.addClass("activated"),this.config=JSON.decode(this.module.get("data-config")),this.config.animation_function=eval(this.config.animation_function),this.arts=this.module.getElements(".nspArt"),this.arts_pages=this.module.getElements(".nspArtPage"),this.arts_per_page=this.config.news_column*this.config.news_rows,this.hover_anim=this.module.hasClass("hover"),this.links=this.module.getElement(".nspLinkScroll1")?this.module.getElement(".nspLinkScroll1").getElements("li"):[],this.links_pages=this.module.getElements(".nspList"),this.links_pages_amount=Math.ceil(Math.ceil(this.links.length/this.config.links_amount)/this.config.links_columns_amount),this.modInterface={top:this.module.getElement(".nspTopInterface"),bottom:this.module.getElement(".nspBotInterface")},this.pages_amount=Math.ceil(this.arts.length/this.arts_per_page)},init_interface:function(){var a=this;this.arts.length>0&&(this.arts_block_width=100,this.arts_scroller=new Fx.Tween(a.module.getElement(".nspArtScroll2"),{duration:a.config.animation_speed,wait:!1,property:"margin-left",unit:"%",transition:a.config.animation_function})),this.module.addEvents({mouseenter:function(){a.module.hasClass("onhover")||a.module.addClass("onhover")},mouseleave:function(){a.module.hasClass("onhover")&&a.module.removeClass("onhover")}}),this.links.length>0&&(this.links_block_width=100,this.links_scroller=new Fx.Tween(a.module.getElement(".nspLinkScroll2"),{duration:a.config.animation_speed,wait:!1,property:"margin-left",unit:"%",transition:a.config.animation_function})),this.nsp_art_list(0,"top"),this.nsp_art_list(0,"bottom"),this.modInterface.top&&this.modInterface.top.getElement(".nspPagination")&&this.modInterface.top.getElement(".nspPagination").getElements("li").each(function(b,c){b.addEvent(a.hover_anim?"mouseenter":"click",function(b){b.preventDefault(),a.arts_anim(c)})}),this.modInterface.top&&this.modInterface.top.getElement(".nspPrev")&&(this.modInterface.top.getElement(".nspPrev").addEvent("click",function(b){b.preventDefault(),a.arts_anim("prev")}),this.modInterface.top.getElement(".nspNext").addEvent("click",function(b){b.preventDefault(),a.arts_anim("next")})),this.modInterface.bottom&&this.modInterface.bottom.getElement(".nspPagination")&&this.modInterface.bottom.getElement(".nspPagination").getElements("li").each(function(b,c){b.addEvent(a.hover_anim?"mouseenter":"click",function(b){b.preventDefault(),a.lists_anim(c)})}),this.modInterface.bottom&&this.modInterface.bottom.getElement(".nspPrev")&&(this.modInterface.bottom.getElement(".nspPrev").addEvent("click",function(b){b.preventDefault(),a.lists_anim("prev")}),this.modInterface.bottom.getElement(".nspNext").addEvent("click",function(b){b.preventDefault(),a.lists_anim("next")})),this.module.hasClass("autoanim")&&function(){a.nsp_gk5_autoanim()}.delay(a.config.animation_interval);var b=this.module.getElement(".nspArts");if(b){var c=0,d=0,e=0,f=!1;b.addEvent("touchstart",function(a){f=!0,a.changedTouches.length>0&&(c=a.changedTouches[0].pageX,d=a.changedTouches[0].pageY,e=(new Date).getTime())}),b.addEvent("touchmove",function(a){a.changedTouches.length>0&&f&&(Math.abs(a.changedTouches[0].pageX-c)>Math.abs(a.changedTouches[0].pageY-d)?a.preventDefault():f=!1)}),b.addEvent("touchend",function(b){b.changedTouches.length>0&&f&&Math.abs(b.changedTouches[0].pageX-c)>=a.swipe_min_move&&(new Date).getTime()-e<=a.swipe_max_time&&(b.changedTouches[0].pageX-c>0?a.arts_anim("prev"):a.arts_anim("next"))})}var g=this.module.getElement(".nspLinksWrap");if(g){var h=0,i=0,j=0,k=!1;g.addEvent("touchstart",function(a){k=!0,a.changedTouches.length>0&&(h=a.changedTouches[0].pageX,i=a.changedTouches[0].pageY,j=(new Date).getTime())}),g.addEvent("touchmove",function(a){a.changedTouches.length>0&&k&&(Math.abs(a.changedTouches[0].pageX-h)>Math.abs(a.changedTouches[0].pageY-i)?a.preventDefault():k=!1)}),g.addEvent("touchend",function(b){b.changedTouches.length>0&&k&&Math.abs(b.changedTouches[0].pageX-h)>=a.swipe_min_move&&(new Date).getTime()-j<=a.swipe_max_time&&(b.changedTouches[0].pageX-h>0?a.lists_anim("prev"):a.lists_anim("next"))})}},nsp_art_list:function(a,b){var c=null!==a?a:"top"==b?this.arts_current:this.links_current;if(this.modInterface[b]&&this.modInterface[b].getElement(".nspPagination")){var d=this.modInterface[b].getElement(".nspPagination");d.getElements("li").setProperty("class",""),d.getElements("li")[c].setProperty("class","active")}},arts_anim:function(a){if(!this.anim_arts){var b=this;this.anim_arts=!0,this.arts_pages[this.arts_current].removeClass("active"),"next"==a?this.arts_current=this.arts_current==this.pages_amount-1?0:this.arts_current+1:"prev"==a?this.arts_current=0==this.arts_current?this.pages_amount-1:this.arts_current-1:this.arts_current=a,this.arts_scroller.start(-1*this.arts_current*this.arts_block_width),function(){b.arts_pages[b.arts_current].addClass("active")}.delay(.5*this.config.animation_speed),function(){b.anim_arts=!1}.delay(this.config.animation_speed),this.nsp_art_list(this.arts_current,"top"),this.animation=!1,function(){b.animation=!0}.delay(.8*this.config.animation_interval)}},lists_anim:function(a){if(!this.anim_lists){var b=this;this.anim_lists=!0;for(var c=0;c<this.config.links_columns_amount;c++){var d=this.links_pages[this.links_current*this.config.links_columns_amount+c];d&&d.removeClass("active")}"next"==a?this.links_current=this.links_current==this.links_pages_amount-1?0:this.links_current+1:"prev"==a?this.links_current=0==this.links_current?this.links_pages_amount-1:this.links_current-1:b.links_current=a,function(){b.anim_lists=!1}.delay(this.config.animation_speed),function(){for(var a=0;a<b.config.links_columns_amount;a++){var c=b.links_pages[b.links_current*b.config.links_columns_amount+a];c&&c.addClass("active")}}.delay(.5*this.config.animation_speed),this.links_scroller.start(-1*this.links_current*this.links_block_width),this.nsp_art_list(null,"bottom")}},nsp_gk5_autoanim:function(){var a=this;this.module.hasClass("onhover")||this.arts_anim("next"),function(){a.nsp_gk5_autoanim()}.delay(a.config.animation_interval)}});window.addEvent("load",function(){$$(".nspMain").each(function(a){a.hasClass("activated")||new NSP5(a)})});
